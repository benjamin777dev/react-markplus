function prompt_for_a_value(e,t){$(document).on("opened","#"+e+"-modal",function(){$("#"+e+"-code").focus()}),$("#"+e+"-code").keyup(function(t){13==t.which&&$("#"+e+"-confirm").click()}),$(document).on("confirmation","#"+e+"-modal",function(){var o=$("#"+e+"-code").val().trim();o.length>0&&(t(o),$("#"+e+"-code").val(""))})}function get_editor_scroll(){var e=$(".ui-layout-east article > [data-source-line]"),t=[];e.each(function(){t.push($(this).data("source-line"))});for(var o=[],i=0,r=0;r<t[t.length-1];r++)-1!==$.inArray(r+1,t)&&o.push(i),i+=editor.session.getRowLength(r);for(var n=editor.session.getScrollTop()/editor.renderer.lineHeight,s=!1,a=!1,r=0;r<o.length;r++){if(!(o[r]<n)){a=r;break}s=r}var d=0,c=editor.session.getScreenLength()-1;s!==!1&&(d=o[s]),a!==!1&&(c=o[a]);var l=0;return c!==d&&(l=(n-d)/(c-d)),{lastMarker:t[s],nextMarker:t[a],percentage:l}}function set_preview_scroll(e){var t=0,o=$(".ui-layout-east article").outerHeight()-$(".ui-layout-east").height();void 0!==e.lastMarker&&(t=$(".ui-layout-east article").find('>[data-source-line="'+e.lastMarker+'"]').get(0).offsetTop),void 0!==e.nextMarker&&(o=$(".ui-layout-east article").find('>[data-source-line="'+e.nextMarker+'"]').get(0).offsetTop),scrollPosition=t+(o-t)*e.percentage,$(".ui-layout-east").animate({scrollTop:scrollPosition},32)}String.prototype.repeat=function(e){return new Array(e+1).join(this)},$(document).on("closed",".remodal",function(e){editor.focus()});var sync_preview=_.debounce(function(){set_preview_scroll(get_editor_scroll())},32,!1),lazy_change=_.debounce(function(){mdc.init(editor.session.getValue(),!1),sync_preview()},256,!1),Vim=ace.require("ace/keyboard/vim").CodeMirror.Vim;Vim.defineEx("write","w",function(e,t){console.log("write")}),Vim.defineEx("quit","q",function(e,t){"q"===t.input?console.log("quit"):"q!"===t.input&&console.log("quit without warning")}),Vim.defineEx("wq","wq",function(e,t){console.log("write then quit")});var editor;$(function(){$("body").layout({resizerDblClickToggle:!1,resizable:!1,slidable:!1,togglerLength_open:"100%",togglerLength_closed:"100%",north:{size:"auto",togglerTip_open:$("#toolbar").data("open-title"),togglerTip_closed:$("#toolbar").data("closed-title")},east:{size:"50%",togglerTip_open:$("#preview").data("open-title"),togglerTip_closed:$("#preview").data("closed-title"),onresize:function(){$(".markdown-body").css("padding-bottom",$(".ui-layout-east").height()-parseInt($(".markdown-body").css("line-height"))+1+"px")}},center:{onresize:function(){editor.session.setUseWrapMode(!1),editor.session.setUseWrapMode(!0)}}}),$(".markdown-body").css("padding-bottom",$(".ui-layout-east").height()-parseInt($(".markdown-body").css("line-height"))+1+"px"),editor=ace.edit("editor"),editor.session.setUseWorker(!1),editor.$blockScrolling=1/0,editor.renderer.setShowPrintMargin(!1),editor.session.setMode("ace/mode/markdown"),editor.session.setUseWrapMode(!0),editor.setScrollSpeed(1),editor.setOption("scrollPastEnd",!0),editor.session.setFoldStyle("manual"),editor.focus(),editor.session.on("changeScrollTop",function(e){sync_preview()});var e=Cookies.get("key-binding");void 0==e&&(e="default"),$("select#key-binding").val(e),"default"!==e&&editor.setKeyboardHandler(ace.require("ace/keyboard/"+e).handler);var t=Cookies.get("editor-font-size");void 0==t&&(t="14"),$("select#editor-font-size").val(t),editor.setFontSize(t+"px");var o=Cookies.get("editor-theme");void 0==o&&(o="tomorrow_night_eighties"),$("select#editor-theme").val(o),editor.setTheme("ace/theme/"+o),$("select#key-binding").change(function(){var e=$(this).val();Cookies.set("key-binding",e,{expires:1e4}),"default"==e?editor.setKeyboardHandler(null):editor.setKeyboardHandler(ace.require("ace/keyboard/"+e).handler)}),$("select#editor-font-size").change(function(){var e=$(this).val();Cookies.set("editor-font-size",e,{expires:1e4}),editor.setFontSize(e+"px")}),$("select#editor-theme").change(function(){var e=$(this).val();Cookies.set("editor-theme",e,{expires:1e4}),editor.setTheme("ace/theme/"+e)}),editor.selection.smartRange=function(){var e=editor.selection.getRange();if(!e.isEmpty())return e;var t=e;return e=editor.selection.getWordRange(e.start.row,e.start.column),0==editor.session.getTextRange(e).trim().length&&(e=t),e},editor.commands.addCommands([{name:"preferences",bindKey:{win:"Ctrl-,",mac:"Command-,"},exec:function(e){$("i.fa-cog").click()}}]),editor.session.on("change",function(){lazy_change()}),$(".heading-icon").click(function(){var e=$(this).data("level"),t=editor.getCursorPosition();t.column+=e+1,editor.navigateTo(editor.getSelectionRange().start.row,0),editor.insert("#".repeat(e)+" "),editor.moveCursorToPosition(t),editor.focus()}),$(".styling-icon").click(function(){var e=$(this).data("modifier"),t=editor.selection.smartRange(),o=editor.getCursorPosition();o.column+=e.length,editor.session.replace(t,e+editor.session.getTextRange(t)+e),editor.moveCursorToPosition(o),editor.selection.clearSelection(),editor.focus()}),$("#horizontal-rule").click(function(){var e=editor.getCursorPosition();0==e.column?(editor.selection.clearSelection(),editor.insert("\n---\n")):(editor.navigateTo(editor.getSelectionRange().start.row,Number.MAX_VALUE),editor.insert("\n\n---\n")),editor.focus()}),$(".list-icon").click(function(){var e=$(this).data("prefix"),t=editor.getCursorPosition();t.column+=e.length;for(var o=editor.selection.getRange(),i=o.start.row+1;i<o.end.row+2;i++)editor.gotoLine(i),editor.insert(e);editor.moveCursorToPosition(t),editor.focus()}),$("#link-icon").click(function(){var e=editor.selection.smartRange(),t=editor.session.getTextRange(e);0==t.trim().length&&(t=$(this).data("sample-text"));var o=$(this).data("sample-url");editor.session.replace(e,"["+t+"]("+o+")"),editor.focus()}),$("#image-icon").click(function(){var e=editor.session.getTextRange(editor.selection.getRange()).trim();0==e.length&&(e=$(this).data("sample-text"));var t=$(this).data("sample-url");editor.insert("!["+e+"]("+t+")"),editor.focus()}),$("#code-icon").click(function(){var e=editor.session.getTextRange(editor.selection.getRange()).trim();editor.insert("\n```\n"+e+"\n```\n"),editor.focus(),editor.navigateUp(2),editor.navigateLineEnd()}),$("#table-icon").click(function(){var e=$(this).data("sample");editor.insert("");var t=editor.getCursorPosition();0==t.column?(editor.selection.clearSelection(),editor.insert("\n"+e+"\n\n")):(editor.navigateTo(editor.getSelectionRange().start.row,Number.MAX_VALUE),editor.insert("\n\n"+e+"\n")),editor.focus()}),prompt_for_a_value("emoji",function(e){/^:.+:$/.test(e)&&(e=/^:(.+):$/.exec(e)[1]),editor.insert(":"+e+":")}),prompt_for_a_value("fa",function(e){"fa-"==e.substring(0,3)&&(e=e.substring(3)),editor.insert(":fa-"+e+":")}),prompt_for_a_value("ion",function(e){"ion-"==e.substring(0,4)&&(e=e.substring(4)),editor.insert(":ion-"+e+":")}),$("#math-icon").click(function(){var e=editor.session.getTextRange(editor.selection.getRange()).trim();0==e.length&&(e=$(this).data("sample")),editor.insert("\n```math\n"+e+"\n```\n"),editor.focus()}),$(".mermaid-icon").click(function(){var e=editor.session.getTextRange(editor.selection.getRange()).trim();0==e.length&&(e=$(this).data("sample")),editor.insert("\n```\n"+e+"\n```\n"),editor.focus()})});